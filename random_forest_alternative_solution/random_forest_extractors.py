from typing import List
from androguard.core.analysis.analysis import MethodAnalysis
from gensim.models import Word2Vec
import numpy as np


class RandomForestExtractors:
    def __init__(self, nodes: List[MethodAnalysis]) -> None:
        sentences = list()
        for i in nodes:
            sentences.append([i.class_name, i.method.name])
        self.word2vec_model = Word2Vec(sentences, min_count=1)

    def get_features(self, node: MethodAnalysis):
        function_name = np.average(
            self.word2vec_model.wv[[node.class_name, node.method.name]], axis=0)
        return {
            'function_name': function_name
        }
